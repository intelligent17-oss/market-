<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sell Product ‚Äî Intelligent Marketplace</title>

<!-- ‚úÖ Telegram WebApp SDK -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
  :root {
    --bg: #f7f7f7;
    --text: #111;
    --button-bg: #000;
    --button-text: #fff;
    --card-bg: #ffffff;
  }

  /* Dark theme */
  body.dark {
    --bg: #0f1113;
    --text: #e6eef8;
    --button-bg: #222;
    --button-text: #fff;
    --card-bg: #151719;
  }

  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: var(--bg);
    color: var(--text);
    transition: background 0.25s, color 0.25s;
  }

  h2,h3 { margin-bottom:10px; }
  input, textarea, select, button {
    width:100%; padding:10px; margin:6px 0;
    background: var(--card-bg);
    color: var(--text);
    border: 1px solid #999;
    border-radius: 6px;
  }

  button {
    background: var(--button-bg);
    color: var(--button-text);
    border:none; cursor:pointer;
  }

  button:disabled { background:#555; cursor:not-allowed; }
  .hidden { display:none; }
  .nav { display:flex; gap:10px; margin-top:20px; }
  .nav button { flex:1; }
  a { color:blue; }
  #userInfo { margin-bottom:15px; }
  #userInfo img {
    border-radius:50%; width:60px; height:60px; object-fit:cover;
    display:block; margin-bottom:5px;
  }

  /* Toggle button */
  #themeToggle {
    position: fixed;
    top: 5px;
    right: 5px;
    background: var(--button-bg);
    color: var(--button-text);
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 12px;
    cursor: pointer;
    z-index: 999;
  }
</style>
</head>
<body>

<!-- Theme Toggle -->
<button id="themeToggle" aria-label="Toggle theme">üåô Dark Mode</button>

<h2>Step 1: Share our bot link on your WhatsApp status and some groups & people to start selling account</h2>
<p>Post the bot link on your WhatsApp status and at least 5 groups/contacts:</p>

<a href="">
<button id="waBtn">Share and start posting account</button>
</a>

<p>Then upload a screenshot to unlock the selling form:</p>
<input type="file" id="screenshot" accept="image/*">

<div id="formContainer" class="hidden">

  <!-- Telegram user info -->
  <div id="userInfo">
    <h3>Logged in as:</h3>
    <img id="profilePic" src="https://via.placeholder.com/60" alt="Profile">
    <p id="fullName"></p>
    <p id="username"></p>
    <p id="userId"></p>
  </div>

  <h2>Step 2: Sell your product</h2>
  <label>Product Name</label>
  <input type="text" id="productName">

  <label>Upload local product image (preview only)</label>
  <input type="file" id="localImage" accept="image/*">

  <label>Host image (paste URL after hosting)</label>
  <p>Need hosting? <a href="https://imgbb.com/" target="_blank">Use imgbb</a></p>
  <input type="url" id="hostedImage" placeholder="https://i.imgur.com/...">

  <label>Product URL</label>
  <input type="url" id="productUrl" placeholder="https://...">

  <label>Price</label>
  <input type="number" id="productPrice" placeholder="5000">
  <select id="currency">
    <option value="NGN">NGN</option>
    <option value="USD">$ USD</option>
  </select>

  <label>Description</label>
  <textarea id="description"></textarea>

  <label>Contact info (WhatsApp / Telegram / Other)</label>
  <input type="text" id="contactInfo">

  <button id="submitBtn">Submit Product</button>

  <p id="statusMsg" class="hidden"></p>
</div>

<div class="nav">
  <button id="reloadBtn">Sell Account</button>
  <button id="marketBtn">Marketplace</button>
</div>

<!-- Monetag SDK -->
<script src="//libtl.com/sdk.js" data-zone="9830606" data-sdk="show_9830606"></script>

<script>
/* ============================================================
      ‚úÖ Theme System
============================================================ */

const themeToggle = document.getElementById("themeToggle");

// Load user preference
let savedTheme = localStorage.getItem("theme");

function applyTheme(theme){
  if(theme === "dark"){
    document.body.classList.add("dark");
    themeToggle.textContent = "‚òÄ Light Mode";
  } else {
    document.body.classList.remove("dark");
    themeToggle.textContent = "üåô Dark Mode";
  }
}

if(!savedTheme){
  if(window.matchMedia("(prefers-color-scheme: dark)").matches){
    applyTheme("dark");
  } else {
    applyTheme("light");
  }
} else {
  applyTheme(savedTheme);
}

if(!savedTheme && window.matchMedia){
  window.matchMedia("(prefers-color-scheme: dark)").addEventListener
  ? window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change', e => {
      applyTheme(e.matches ? "dark" : "light");
    })
  : window.matchMedia("(prefers-color-scheme: dark)").addListener(e => {
      applyTheme(e.matches ? "dark" : "light");
    });
}

themeToggle.onclick = () => {
  const nowDark = document.body.classList.toggle("dark");
  applyTheme(nowDark ? "dark" : "light");
  try{ localStorage.setItem("theme", nowDark ? "dark" : "light"); } catch(e){}
};

/* ============================================================
      ‚úÖ Telegram WebApp
============================================================ */

const tg = window.Telegram.WebApp;
tg.expand();
tg.setBackgroundColor("secondary_bg_color");
Telegram.WebApp.ready();

const BOT_TOKEN = '7514817340:AAHUpE5ZPEUZkkM4rq4smoV_nzWfmwWBVGc';
const ADMIN_ID = '6976365864';
const WHATSAPP_LINK = "https://wa.me/?text=*Hey%20guy's%20%F0%9F%91%8B*%20%20%20*%E2%98%91%EF%B8%8F%20Are%20you%20finding%20a%20marketplace%20where%20you%20can%20buy%20and%20sell%20any%20social%20media%20account%2C%20tool%2C%20website%20and%20many%20more%F0%9F%A7%A9*%20%20%20*%F0%9F%91%A9%E2%80%8D%F0%9F%92%BB%20you%20can%20also%20generate%20a%20hacking%20links%20you%20can%20use%20to%20hack%20any%20social%20media%20account%20for%20free%20and%20also%20USA%2FUK%20Banks%20%E2%9C%85*%20%20%20*%F0%9F%91%87%F0%9F%91%87%F0%9F%91%87%F0%9F%91%87%F0%9F%91%87%F0%9F%91%87*%20*https%3A%2F%2Ft.me%2Fintelligentmarketbot%3Fstart%3Dar1810544353";

const waBtn = document.getElementById('waBtn');
const screenshot = document.getElementById('screenshot');
const formContainer = document.getElementById('formContainer');
const submitBtn = document.getElementById('submitBtn');
const statusMsg = document.getElementById('statusMsg');
const reloadBtn = document.getElementById('reloadBtn');
const marketBtn = document.getElementById('marketBtn');

const tgUser = Telegram.WebApp.initDataUnsafe.user || {};

document.getElementById('fullName').textContent =
  (tgUser.first_name || "") + (tgUser.last_name ? " " + tgUser.last_name : "");
document.getElementById('username').textContent =
  tgUser.username ? '@' + tgUser.username : '';
document.getElementById('userId').textContent =
  'Telegram ID: ' + (tgUser.id || '');
if(tgUser.photo_url) document.getElementById('profilePic').src = tgUser.photo_url;

waBtn.onclick = () => {
    showAd();
    window.open(WHATSAPP_LINK, '_blank', 'noopener');
};

screenshot.onchange = () => formContainer.classList.remove('hidden');

reloadBtn.onclick = () => { showAd(); location.reload(); };
marketBtn.onclick = () => window.location.href='buy.html';

function showAd() {
    if (typeof show_9830606 === "function") {
        show_9830606();
    } else {
        setTimeout(showAd, 500);
    }
}

window.addEventListener("load", () => {
    setTimeout(() => {
        showAd();
        setInterval(showAd, 30000);
    }, 3000);
});

document.querySelectorAll('button').forEach(b => {
    if(b.id !== 'marketBtn'){
        b.addEventListener('click', showAd);
    }
});

/* ============================================================
      ‚≠ê Product Submission (works with hosted image link)
============================================================ */
function submitProduct(){
  const name = document.getElementById('productName').value;
  const img = document.getElementById('hostedImage').value;
  const url = document.getElementById('productUrl').value;
  const price = document.getElementById('productPrice').value;
  const currency = document.getElementById('currency').value;
  const desc = document.getElementById('description').value;
  const contact = document.getElementById('contactInfo').value;

  if(!name){ 
    alert('Enter product name'); 
    return;
  }

  const productId = 'P'+Date.now()+Math.floor(Math.random()*99);
  const dt = new Date().toLocaleString('en-GB', {timeZone:'Africa/Lagos'});

  const sellerId = tgUser.id || '';
  const sellerUsername = tgUser.username ? '@'+tgUser.username : '';
  const sellerName = tgUser.first_name + (tgUser.last_name ? ' '+tgUser.last_name : '');

  const adminMessage = `
üì¶ New Product Submitted
Product ID: ${productId}
Name: ${name}
Price: ${price ? price+' '+currency : ''}
Image Link: ${img || 'N/A'}
URL: ${url}
Description: ${desc}
Contact: ${contact}
Seller: ${sellerName} ${sellerUsername}
Seller ID: ${sellerId}
Date & Time: ${dt}
`;

  const sellerMessage = `
‚úÖ Your product submission is received and pending admin review
Product Name: ${name}
Product ID: ${productId}
Price: ${price ? price+' '+currency : ''}
`;

  statusMsg.textContent = "Submitting product...";
  statusMsg.classList.remove('hidden');
  statusMsg.style.color = 'orange';

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ chat_id: ADMIN_ID, text: adminMessage })
  })
  .then(res => res.json())
  .then(adminResp => {
      if(adminResp.ok){
          if(sellerId){
              fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
                  method:'POST',
                  headers:{'Content-Type':'application/json'},
                  body: JSON.stringify({ chat_id: sellerId, text: sellerMessage })
              });
          }
          statusMsg.textContent = `‚úÖ Product "${name}" submitted successfully! Product ID: ${productId}`;
          statusMsg.style.color = 'green';
          formContainer.querySelectorAll('input, textarea').forEach(i=>i.value='');
      } else {
          statusMsg.textContent = '‚ùå Submission failed. Try again!';
          statusMsg.style.color = 'red';
      }
  })
  .catch(err => {
      console.error(err);
      statusMsg.textContent = '‚ùå Submission failed. Try again!';
      statusMsg.style.color = 'red';
  });
}

submitBtn.addEventListener('click', submitProduct);
</script>
</body>
</html>